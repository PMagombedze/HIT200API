{% include 'imports.html' %}

<script>
    const token = cookie.get('admin_dash_token');
    if (!token) {
        window.location.href = '/e/404';
    }

    fetch('/api/verifyToken', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
        }
    })
        .then(response => response.json())
        .then(data => {
            if (data.message === "Token is valid" && data.is_admin === true) {
                const user_email = document.getElementById('user-email');
                user_email.textContent = data.email;
                document.querySelector('.notifications-section').style.display = 'block';
                document.querySelector('#notifications').classList.add('has-text-link');
            } else {
                window.location.href = '/e/404';
            }
        })
        .catch(error => {
            window.location.href = '/e/404';
        });

    fetch('/api/user/profile', {
        method: 'GET',
        headers: {
            'Authorization': `Bearer ${token}`
        }
    })
        .then(response => response.json())
        .then(data => {
            if (data.message === "Profile pic found") {
                document.querySelector('#pro-pic').src = '/api/uploads/' + data.img_url;
            } else {
                document.querySelector('#pro-pic').src = '/static/images/user.svg';
            }
        })
        .catch(error => {
            console.error('Error fetching profile picture:', error);
        });
</script>

<div class="notifications-section" style="display: none;">
    <!--dashboard navbar-->
    {% include 'admin/navbar.html' %}

    <!--dashboard sidebar-->
    <div style="display: flex;">
        {% include 'admin/sidebar.html' %}

        <!--dashboard content-->
        <div class="container is-fluid" style="height: 100vh; overflow-y: auto;">
            <h1 style="margin-top: 50px;" class="title">Notifications</h1>
            <div class="box"
                style="border: 1px solid #f1f1f1;box-shadow: rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px;">
                <div class="media" style="border-bottom: 1px solid #f1f1f1;">
                    <figure class="media-left">
                        <p class="image is-64x64">
                            <img class="mt-3" style="width: 50px; height: 50px; border-radius: 50%;" id="pro-pic" src="/static/images/user.svg" alt="Profile Picture">
                        </p>
                    </figure>
                    <div class="media-content">
                        <div class="content">
                            <p>
                                <a id="user-email"></a>
                                <br>
                                <a style="color: #000;">You have new notifications.</a>
                                <br>
                                <a style="color: #acacac;">Thur, 26</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="box"
                style="border: 1px solid #f1f1f1;box-shadow: rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px;">
                <div class="media" style="border-bottom: 1px solid #f1f1f1;">
                    <figure class="media-left">
                        <p class="image is-64x64">
                            <img class="mt-3" style="width: 50px; height: 50px; border-radius: 50%;" src="/static/images/user.svg" alt="Profile Picture">
                        </p>
                    </figure>
                    <div class="media-content">
                        <div class="content">
                            <p>
                                <a style="color: #000;">Another notification.</a>
                                <br>
                                <a style="color: #acacac;">Fri, 27</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="box"
                style="border: 1px solid #f1f1f1;box-shadow: rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px;">
                <div class="media" style="border-bottom: 1px solid #f1f1f1;">
                    <figure class="media-left">
                        <p class="image is-64x64">
                            <img class="mt-3" style="width: 50px; height: 50px; border-radius: 50%;" src="/static/images/user.svg" alt="Profile Picture">
                        </p>
                    </figure>
                    <div class="media-content">
                        <div class="content">
                            <p>
                                <a style="color: #000;">Yet another notification.</a>
                                <br>
                                <a style="color: #acacac;">Sat, 28</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>